<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Genetic Management of Small Populations (Examples-Tasks)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Ali Ranjbaranghaleh_files/libs/clipboard/clipboard.min.js"></script>
<script src="Ali Ranjbaranghaleh_files/libs/quarto-html/quarto.js"></script>
<script src="Ali Ranjbaranghaleh_files/libs/quarto-html/popper.min.js"></script>
<script src="Ali Ranjbaranghaleh_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Ali Ranjbaranghaleh_files/libs/quarto-html/anchor.min.js"></script>
<link href="Ali Ranjbaranghaleh_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Ali Ranjbaranghaleh_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="Ali Ranjbaranghaleh_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="Ali Ranjbaranghaleh_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Ali Ranjbaranghaleh_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Ali Ranjbaranghaleh_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="Ali Ranjbaranghaleh_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#exercise1" id="toc-exercise1" class="nav-link" data-scroll-target="#exercise1">Exercise1</a>
  <ul class="collapse">
  <li><a href="#question" id="toc-question" class="nav-link" data-scroll-target="#question">Question</a></li>
  <li><a href="#answer" id="toc-answer" class="nav-link" data-scroll-target="#answer">Answer</a></li>
  </ul></li>
  <li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2">Exercise 2</a>
  <ul class="collapse">
  <li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question</a></li>
  <li><a href="#answer-1" id="toc-answer-1" class="nav-link" data-scroll-target="#answer-1">Answer</a></li>
  </ul></li>
  <li><a href="#exercise-3" id="toc-exercise-3" class="nav-link" data-scroll-target="#exercise-3">Exercise 3</a>
  <ul class="collapse">
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question</a></li>
  <li><a href="#answer-2" id="toc-answer-2" class="nav-link" data-scroll-target="#answer-2">Answer</a></li>
  </ul></li>
  <li><a href="#exercise-4" id="toc-exercise-4" class="nav-link" data-scroll-target="#exercise-4">Exercise 4</a>
  <ul class="collapse">
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question</a></li>
  <li><a href="#answer-3" id="toc-answer-3" class="nav-link" data-scroll-target="#answer-3">Answer</a></li>
  </ul></li>
  <li><a href="#exercise-5" id="toc-exercise-5" class="nav-link" data-scroll-target="#exercise-5">Exercise 5</a>
  <ul class="collapse">
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question</a></li>
  <li><a href="#answer-4" id="toc-answer-4" class="nav-link" data-scroll-target="#answer-4">Answer</a></li>
  </ul></li>
  <li><a href="#exercise-6" id="toc-exercise-6" class="nav-link" data-scroll-target="#exercise-6">Exercise 6</a>
  <ul class="collapse">
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question</a></li>
  <li><a href="#answer-5" id="toc-answer-5" class="nav-link" data-scroll-target="#answer-5">Answer</a></li>
  </ul></li>
  <li><a href="#exercise-7" id="toc-exercise-7" class="nav-link" data-scroll-target="#exercise-7">Exercise 7</a>
  <ul class="collapse">
  <li><a href="#question-6" id="toc-question-6" class="nav-link" data-scroll-target="#question-6">Question</a></li>
  <li><a href="#answer-6" id="toc-answer-6" class="nav-link" data-scroll-target="#answer-6">Answer</a></li>
  </ul></li>
  <li><a href="#exercise-8" id="toc-exercise-8" class="nav-link" data-scroll-target="#exercise-8">Exercise 8</a>
  <ul class="collapse">
  <li><a href="#question-7" id="toc-question-7" class="nav-link" data-scroll-target="#question-7">Question</a></li>
  <li><a href="#answer-7" id="toc-answer-7" class="nav-link" data-scroll-target="#answer-7">Answer</a></li>
  </ul></li>
  <li><a href="#exercise-9" id="toc-exercise-9" class="nav-link" data-scroll-target="#exercise-9">Exercise 9</a>
  <ul class="collapse">
  <li><a href="#question-8" id="toc-question-8" class="nav-link" data-scroll-target="#question-8">Question</a></li>
  <li><a href="#answer-8" id="toc-answer-8" class="nav-link" data-scroll-target="#answer-8">Answer</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Genetic Management of Small Populations (Examples-Tasks)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>These Tasks have been created by <a href="https://www.researchgate.net/profile/Gabriela-Cielen" title="ResearchGate Profile">Gabriela Cielen</a>, MSc, PhD student (Department of Genetics and Animal Breeding - Poznan University of Life Sciences)</p>
<p>In this webpage I am trying not only to define some definitions based on her teaching slides in “Genetic Management of Small Populations” topic but also trying to solve the tasks included in the booklet she has created for this topic.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
Loading required package: ade4


   /// adegenet 2.1.10 is loaded ////////////

   &gt; overview: '?adegenet'
   &gt; tutorials/doc/questions: 'adegenetWeb()' 
   &gt; bug reports/feature requests: adegenetIssues()</code></pre>
</div>
</div>
<div class="cell">
<style type="text/css">
body.quarto-light {
  background-color: #F8EDE3;
}
body.quarto-dark {
  background-color: #595245;
}
i.bi::before {
    display: table-caption !important;
    height: 2rem !important;
    width: 2rem !important;
    content: "" !important;
    background-repeat: no-repeat !important;
    background-size: 2rem 2rem !important;
    position: sticky !important;
    top: 1rem !important;
}
h1{
    text-align: center;
}
</style>
</div>
</section>
<section id="exercise1" class="level2">
<h2 class="anchored" data-anchor-id="exercise1">Exercise1</h2>
<section id="question" class="level3">
<h3 class="anchored" data-anchor-id="question">Question</h3>
<p>In the three subpopulations were registered the following genotypes:</p>
<p><img src="2.png" class="img-fluid"></p>
<p><img src="1.png" class="img-fluid"></p>
<p><strong>Calculate the Frequencies of genotypes in mentioned Population and Check which one is in the genetic Equilibrium.</strong></p>
</section>
<section id="answer" class="level3">
<h3 class="anchored" data-anchor-id="answer">Answer</h3>
<p><strong>First we create the table(dataframe) based on the given data in the question:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>AA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">26000</span>, <span class="dv">49</span>, <span class="dv">64</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Aa <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18000</span>, <span class="dv">42</span>, <span class="dv">16</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>aa <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">45000</span>, <span class="dv">9</span>, <span class="dv">1</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Population <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Alpha"</span>,<span class="st">"Beta"</span>,<span class="st">"Gamma"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>ex1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Population,AA, Aa, aa)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>ex1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Population    AA    Aa    aa
1      Alpha 26000 18000 45000
2       Beta    49    42     9
3      Gamma    64    16     1</code></pre>
</div>
</div>
<p><strong>Then we can create (mutate) othe columns in the table to measure:</strong></p>
<ol type="1">
<li><p>Population size (Pop_size)</p></li>
<li><p>Frequency of Genotype AA (P)</p></li>
<li><p>Frequency of Genotype Aa (H)</p></li>
<li><p>Frequency of Genotype AA (Q)</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ex1 <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pop_size =</span> AA <span class="sc">+</span> Aa <span class="sc">+</span> aa) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">P =</span> <span class="fu">round</span>(AA<span class="sc">/</span>Pop_size, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">H =</span> <span class="fu">round</span>(Aa<span class="sc">/</span>Pop_size, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Q =</span> <span class="fu">round</span>(aa<span class="sc">/</span>Pop_size, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Population    AA    Aa    aa Pop_size      P      H      Q
1      Alpha 26000 18000 45000    89000 0.2921 0.2022 0.5056
2       Beta    49    42     9      100 0.4900 0.4200 0.0900
3      Gamma    64    16     1       81 0.7901 0.1975 0.0123</code></pre>
</div>
</div>
<p><strong>Besides that, we can go further and calculate the frequencies of Alleles:</strong></p>
<ol type="1">
<li><p>Frequency of Allele a = q</p></li>
<li><p>Frequency of Allele A = p (p = 1-q)</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ex1 <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pop_size =</span> AA <span class="sc">+</span> Aa <span class="sc">+</span> aa) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">P =</span> <span class="fu">round</span>(AA<span class="sc">/</span>Pop_size, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">H =</span> <span class="fu">round</span>(Aa<span class="sc">/</span>Pop_size, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Q =</span> <span class="fu">round</span>(aa<span class="sc">/</span>Pop_size, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#New coulumns (q,p,H_n)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">q =</span> <span class="fu">round</span>(Q<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>H, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">round</span>(P<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>H, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">H_n =</span> <span class="fu">round</span>(<span class="dv">4</span><span class="sc">*</span>p<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>q<span class="sc">^</span><span class="dv">2</span>, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Population    AA    Aa    aa Pop_size      P      H      Q      q      p
1      Alpha 26000 18000 45000    89000 0.2921 0.2022 0.5056 0.6067 0.3932
2       Beta    49    42     9      100 0.4900 0.4200 0.0900 0.3000 0.7000
3      Gamma    64    16     1       81 0.7901 0.1975 0.0123 0.1111 0.8888
     H_n
1 0.2276
2 0.1764
3 0.0390</code></pre>
</div>
</div>
<p>Now we can Check the equilibrium:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ex1_modified <span class="ot">&lt;-</span> ex1 <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">Pop_size =</span> AA <span class="sc">+</span> Aa <span class="sc">+</span> aa) <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">P_obs =</span> <span class="fu">round</span>(AA<span class="sc">/</span>Pop_size, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">H_obs =</span> <span class="fu">round</span>(Aa<span class="sc">/</span>Pop_size, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">Q_obs =</span> <span class="fu">round</span>(aa<span class="sc">/</span>Pop_size, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                <span class="co">#New coulumns (q,p,H_n)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">q =</span> <span class="fu">round</span>(Q_obs<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>H_obs, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">round</span>(P_obs<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>H_obs, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">H_n =</span> <span class="fu">round</span>(<span class="dv">4</span><span class="sc">*</span>p<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>q<span class="sc">^</span><span class="dv">2</span>, <span class="dv">4</span>))<span class="sc">|&gt;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                <span class="co">#Recalculating P, H and Q with p and q to check the results are similar</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                <span class="co">#to first measurements:</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">Drift =</span> <span class="fu">sqrt</span>((p<span class="sc">*</span>q)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>Pop_size)))<span class="sc">|&gt;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">P_exp =</span> <span class="fu">round</span>(p<span class="sc">^</span><span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">Q_exp =</span> <span class="fu">round</span>(q<span class="sc">^</span><span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">H_exp =</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">-</span> P_exp <span class="sc">-</span> Q_exp, <span class="dv">4</span>))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>ex1_modified</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Population    AA    Aa    aa Pop_size  P_obs  H_obs  Q_obs      q      p
1      Alpha 26000 18000 45000    89000 0.2921 0.2022 0.5056 0.6067 0.3932
2       Beta    49    42     9      100 0.4900 0.4200 0.0900 0.3000 0.7000
3      Gamma    64    16     1       81 0.7901 0.1975 0.0123 0.1111 0.8888
     H_n       Drift  P_exp  Q_exp  H_exp
1 0.2276 0.001157667 0.1546 0.3681 0.4773
2 0.1764 0.032403703 0.4900 0.0900 0.4200
3 0.0390 0.024688889 0.7900 0.0123 0.1977</code></pre>
</div>
</div>
<p>It seems populations <strong>Beta</strong> and <strong>Gamma</strong> are in <strong>genetic Equilibrium</strong>.</p>
</section>
</section>
<section id="exercise-2" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2">Exercise 2</h2>
<section id="question-1" class="level3">
<h3 class="anchored" data-anchor-id="question-1">Question</h3>
<p>Based on the data in exercise 1 calculate the F<sub>IS</sub> , F<sub>ST</sub> and F<sub>IT</sub> and the genetic drift.</p>
</section>
<section id="answer-1" class="level3">
<h3 class="anchored" data-anchor-id="answer-1">Answer</h3>
<p>The main steps are:</p>
<p><img src="3.png" class="img-fluid"></p>
<p><img src="4.png" class="img-fluid"></p>
<p><img src="5.png" class="img-fluid"></p>
<p>We have done the steps until Step 3 so far and we go for <strong>Step 4</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ex1_modified <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">F_I =</span> (H_exp <span class="sc">-</span> H_obs)<span class="sc">/</span>H_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Population    AA    Aa    aa Pop_size  P_obs  H_obs  Q_obs      q      p
1      Alpha 26000 18000 45000    89000 0.2921 0.2022 0.5056 0.6067 0.3932
2       Beta    49    42     9      100 0.4900 0.4200 0.0900 0.3000 0.7000
3      Gamma    64    16     1       81 0.7901 0.1975 0.0123 0.1111 0.8888
     H_n       Drift  P_exp  Q_exp  H_exp         F_I
1 0.2276 0.001157667 0.1546 0.3681 0.4773 0.576367065
2 0.1764 0.032403703 0.4900 0.0900 0.4200 0.000000000
3 0.0390 0.024688889 0.7900 0.0123 0.1977 0.001011634</code></pre>
</div>
</div>
<p><strong>Step 5 and 6:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p_T <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span><span class="dv">26000</span> <span class="sc">+</span> <span class="dv">18000</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="dv">49</span> <span class="sc">+</span> <span class="dv">42</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="dv">64</span> <span class="sc">+</span> <span class="dv">16</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">89000</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span><span class="dv">100</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span><span class="dv">81</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>p_T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3940525</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>q_T <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_T</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>q_T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6059475</code></pre>
</div>
</div>
<p><strong>Step 7:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>H_I <span class="ot">&lt;-</span> (<span class="fl">0.2022</span> <span class="sc">*</span> <span class="dv">89000</span> <span class="sc">+</span> <span class="fl">0.4200</span> <span class="sc">*</span> <span class="dv">100</span> <span class="sc">+</span> <span class="fl">0.1975</span> <span class="sc">*</span> <span class="dv">81</span>) <span class="sc">/</span> (<span class="dv">89000</span> <span class="sc">+</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">81</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>H_I</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.20244</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>H_S <span class="ot">&lt;-</span> (<span class="fl">0.4773</span> <span class="sc">*</span> <span class="dv">89000</span> <span class="sc">+</span> <span class="fl">0.4200</span> <span class="sc">*</span> <span class="dv">100</span> <span class="sc">+</span> <span class="fl">0.1977</span> <span class="sc">*</span> <span class="dv">81</span>) <span class="sc">/</span> (<span class="dv">89000</span> <span class="sc">+</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">81</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>H_S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4769818</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>H_T <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(p_T<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>q_T<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>H_T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4775503</code></pre>
</div>
</div>
<p><strong>Step 8:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>F_IS <span class="ot">&lt;-</span> (H_S <span class="sc">-</span> H_I) <span class="sc">/</span> H_S</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>F_IS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5755814</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>F_ST <span class="ot">&lt;-</span> (H_T <span class="sc">-</span> H_S) <span class="sc">/</span> H_T</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>F_ST</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0011904</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>F_IT <span class="ot">&lt;-</span> (H_T <span class="sc">-</span> H_I) <span class="sc">/</span> H_T</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>F_IT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5760866</code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-3" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3">Exercise 3</h2>
<section id="question-2" class="level3">
<h3 class="anchored" data-anchor-id="question-2">Question</h3>
<p>Based on the frequencies in the table below calculate HET Coefficient for each population. L1-L5 are locus 1-5 with allele frequencies.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="369"></p>
</figure>
</div>
</section>
<section id="answer-2" class="level3">
<h3 class="anchored" data-anchor-id="answer-2">Answer</h3>
<p>First we create the dataframe(table):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Pop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Blue"</span>,<span class="st">"Red"</span>,<span class="st">"Green"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>L2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>L3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">0</span>,<span class="fl">0.2</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>L4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.35</span>,<span class="fl">0.5</span>,<span class="fl">0.2</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>L5 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>,<span class="fl">0.2</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>ex3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(L1,L2,L3,L4,L5, <span class="at">row.names =</span> Pop)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>ex3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       L1  L2  L3   L4   L5
Blue  0.1 0.2 0.3 0.35 0.05
Red   0.0 0.0 0.0 0.50 0.50
Green 0.2 0.2 0.2 0.20 0.20</code></pre>
</div>
</div>
<p>Based on the formula we create the new column:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ex3 <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HET =</span> <span class="dv">1</span><span class="sc">-</span>(L1<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>L2<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>L3<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>L4<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>L5<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       L1  L2  L3   L4   L5   HET
Blue  0.1 0.2 0.3 0.35 0.05 0.735
Red   0.0 0.0 0.0 0.50 0.50 0.500
Green 0.2 0.2 0.2 0.20 0.20 0.800</code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-4" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4">Exercise 4</h2>
<section id="question-3" class="level3">
<h3 class="anchored" data-anchor-id="question-3">Question</h3>
<p>Based on the data in the table calculate PIC coefficient for each locus and each population.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="8.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="329"></p>
</figure>
</div>
</section>
<section id="answer-3" class="level3">
<h3 class="anchored" data-anchor-id="answer-3">Answer</h3>
<p>We set each Locus for the alleles and populations</p>
<p>Now we can create a function to do the formula fo us:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="9.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="678"></p>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PIC_3 stands for a function to calculate PIC when we have 3 alleles</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>PIC_3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,z) {</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">-</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>z<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span>(<span class="dv">2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>z<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>z<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># PIC_2 stands for a function to calculate PIC when we have 2 alleles</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>PIC_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">-</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span>(<span class="dv">2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we calculate PIC using our functions for each population:</p>
<p><strong>Yellow:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PIC_3</span>(<span class="fl">0.86</span>,<span class="fl">0.12</span>,<span class="fl">0.02</span>) <span class="co">#G1 (A,B,C)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2236963</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PIC_3</span>(<span class="fl">0.32</span>,<span class="fl">0.37</span>, <span class="fl">0.31</span>)<span class="co">#G2 (1,2,3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5905694</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PIC_2</span>(<span class="fl">0.62</span>,<span class="fl">0.38</span>)      <span class="co">#G3 (K,L)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3601853</code></pre>
</div>
</div>
<p><strong>Orange:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PIC_3</span>(<span class="fl">0.80</span>,<span class="fl">0.11</span>,<span class="fl">0.09</span>) <span class="co">#G1 (A,B,C)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.313748</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PIC_3</span>(<span class="fl">0.45</span>,<span class="fl">0.26</span>,<span class="fl">0.29</span>) <span class="co">#G2 (1,2,3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5729912</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PIC_2</span>(<span class="fl">0.46</span>,<span class="fl">0.54</span>)      <span class="co">#G3 (K,L)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3733949</code></pre>
</div>
</div>
<p><strong>Black:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PIC_3</span>(<span class="fl">0.77</span>,<span class="fl">0.20</span>,<span class="fl">0.03</span>) <span class="co">#G1 (A,B,C)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3176288</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PIC_3</span>(<span class="fl">0.22</span>,<span class="fl">0.46</span>,<span class="fl">0.32</span>) <span class="co">#G2 (1,2,3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5638691</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PIC_2</span>(<span class="fl">0.33</span>, <span class="fl">0.67</span>)      <span class="co">#G3 (K,L)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3444296</code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-5" class="level2">
<h2 class="anchored" data-anchor-id="exercise-5">Exercise 5</h2>
<section id="question-4" class="level3">
<h3 class="anchored" data-anchor-id="question-4">Question</h3>
<p>Based on the data below calculate the genetic distances between all populations. The table shows the number of animals with each genotype.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="302"></p>
</figure>
</div>
</section>
<section id="answer-4" class="level3">
<h3 class="anchored" data-anchor-id="answer-4">Answer</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="11.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>First we create our table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>Population <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Brown Swiss"</span>, <span class="st">"Jersey"</span>, <span class="st">"Holstein-Friesian"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>AA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">200</span>,<span class="dv">100</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>Aa <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">200</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>aa <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>ex5 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Population, AA,Aa,aa)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>ex5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Population  AA  Aa  aa
1       Brown Swiss  50 100  50
2            Jersey 200 100 100
3 Holstein-Friesian 100 200 200</code></pre>
</div>
</div>
<p>Now we calculate p and q for each sub-population:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ex5 <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">q =</span> aa<span class="sc">/</span>(AA<span class="sc">+</span>Aa<span class="sc">+</span>aa)<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>((Aa)<span class="sc">/</span>(AA<span class="sc">+</span>Aa<span class="sc">+</span>aa))) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="dv">1</span><span class="sc">-</span>q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Population  AA  Aa  aa     q     p
1       Brown Swiss  50 100  50 0.500 0.500
2            Jersey 200 100 100 0.375 0.625
3 Holstein-Friesian 100 200 200 0.600 0.400</code></pre>
</div>
</div>
<p>Now we can create a function to calculate the genetic distance between 2 populations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>Distance <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,z,w){</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(((x<span class="sc">-</span>y)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (z<span class="sc">-</span>w)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally we can calculate the genetic distance using the Distance function created above between 2 populations:</p>
<p>Brown Swiss - Jersey:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Distance</span>(<span class="fl">0.500</span>, <span class="fl">0.375</span>, <span class="fl">0.500</span>, <span class="fl">0.625</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1767767</code></pre>
</div>
</div>
<p>Brown Swiss - Holstein Friesian</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Distance</span>(<span class="fl">0.500</span>, <span class="fl">0.600</span>, <span class="fl">0.500</span>, <span class="fl">0.400</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1414214</code></pre>
</div>
</div>
<p>Jersey - Holstein Friesian</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Distance</span>(<span class="fl">0.625</span>, <span class="fl">0.400</span>, <span class="fl">0.375</span>, <span class="fl">0.600</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3181981</code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-6" class="level2">
<h2 class="anchored" data-anchor-id="exercise-6">Exercise 6</h2>
<section id="question-5" class="level3">
<h3 class="anchored" data-anchor-id="question-5">Question</h3>
<p>Based on the data below calculate the Nei’s genetic distance between all populations. Table shows the alleles frequency in each locus and population.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="12.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="562"></p>
</figure>
</div>
</section>
<section id="answer-5" class="level3">
<h3 class="anchored" data-anchor-id="answer-5">Answer</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="13.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Here I have don it in excel:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="21.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="22.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="23.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
</section>
<section id="exercise-7" class="level2">
<h2 class="anchored" data-anchor-id="exercise-7">Exercise 7</h2>
<section id="question-6" class="level3">
<h3 class="anchored" data-anchor-id="question-6">Question</h3>
<p>Based on the pedigree presented below calculate the inbreeding coefficient for the animal G, H, I, J and relationship between I-J, J-F, J-G, G-H, I-H.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="548"></p>
</figure>
</div>
</section>
<section id="answer-6" class="level3">
<h3 class="anchored" data-anchor-id="answer-6">Answer</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="15.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="630"></p>
</figure>
</div>
</section>
</section>
<section id="exercise-8" class="level2">
<h2 class="anchored" data-anchor-id="exercise-8">Exercise 8</h2>
<section id="question-7" class="level3">
<h3 class="anchored" data-anchor-id="question-7">Question</h3>
<p>Based on the following data estimate the effective population size rate of inbreeding for each population.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="16.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="342"></p>
</figure>
</div>
</section>
<section id="answer-7" class="level3">
<h3 class="anchored" data-anchor-id="answer-7">Answer</h3>
<p>We create our table first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>Males <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2541</span>, <span class="dv">570</span>, <span class="dv">409</span>, <span class="dv">10992</span>, <span class="dv">1758</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>Females <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2434</span>, <span class="dv">787</span>, <span class="dv">221</span>, <span class="dv">11398</span>, <span class="dv">1471</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>ex8 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Males, Females, <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">"Zatorska goose"</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"Pygmy hippo"</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"Persian onager"</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"Siamang"</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"Lion-Tailed macaque"</span>))</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>ex8</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Males Females
Zatorska goose       2541    2434
Pygmy hippo           570     787
Persian onager        409     221
Siamang             10992   11398
Lion-Tailed macaque  1758    1471</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>ex8 <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">DeltaF =</span> ((<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span><span class="sc">*</span>Males) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span><span class="sc">*</span>Females)))<span class="sc">|&gt;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_e =</span> (<span class="dv">4</span><span class="sc">*</span>Males<span class="sc">*</span>Females)<span class="sc">/</span>(Males<span class="sc">+</span>Females))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Males Females   DeltaF        N_e
Zatorska goose       2541    2434  621.875  4972.6987
Pygmy hippo           570     787  169.625  1322.2992
Persian onager        409     221   78.750   573.8984
Siamang             10992   11398 2798.750 22382.6380
Lion-Tailed macaque  1758    1471  403.625  3203.4909</code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-9" class="level2">
<h2 class="anchored" data-anchor-id="exercise-9">Exercise 9</h2>
<section id="question-8" class="level3">
<h3 class="anchored" data-anchor-id="question-8">Question</h3>
<p>In goose population were 1163 individuals noted as founders and 248 indivituals moted as ancestors. In the table below were listed inbreeding coefficients and number of males and females registered in 22 years. Based on the data in the text and in the table calculate the rate of inbreeding and effective population size for each year and bottleneck effect for this population.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="19.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="394"></p>
</figure>
</div>
</section>
<section id="answer-8" class="level3">
<h3 class="anchored" data-anchor-id="answer-8">Answer</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="17.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="18.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>We create the table for the first step:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>Year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">1991</span>,<span class="dv">1992</span>,<span class="dv">1993</span>,<span class="dv">1994</span>,<span class="dv">1995</span>,<span class="dv">1996</span>,<span class="dv">1997</span>,<span class="dv">1998</span>,<span class="dv">1999</span>,<span class="dv">2000</span>,<span class="dv">2001</span>,<span class="dv">2002</span>,<span class="dv">2003</span>,<span class="dv">2004</span>,<span class="dv">2007</span>,<span class="dv">2008</span>,<span class="dv">2009</span>,<span class="dv">2010</span>,<span class="dv">2011</span>,<span class="dv">2012</span>,<span class="dv">2013</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>Inbreeding_coefficient <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.000</span>,<span class="fl">0.000</span>,<span class="fl">0.000</span>,<span class="fl">0.000</span>,<span class="fl">0.001</span>,<span class="fl">0.004</span>,<span class="fl">0.021</span>,<span class="fl">0.028</span>,<span class="fl">0.016</span>,<span class="fl">0.013</span>,<span class="fl">0.034</span>,<span class="fl">0.018</span>,<span class="fl">0.021</span>,<span class="fl">0.016</span>,<span class="fl">0.021</span>,<span class="fl">0.027</span>,<span class="fl">0.029</span>,<span class="fl">0.030</span>,<span class="fl">0.033</span>,<span class="fl">0.039</span>,<span class="fl">0.048</span>,<span class="fl">0.046</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>Males_N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">198</span>,<span class="dv">262</span>,<span class="dv">255</span>,<span class="dv">196</span>,<span class="dv">182</span>,<span class="dv">283</span>,<span class="dv">291</span>,<span class="dv">33</span>,<span class="dv">131</span>,<span class="dv">119</span>,<span class="dv">61</span>,<span class="dv">120</span>,<span class="dv">6</span>,<span class="dv">23</span>,<span class="dv">135</span>,<span class="dv">81</span>,<span class="dv">32</span>,<span class="dv">41</span>,<span class="dv">56</span>,<span class="dv">25</span>,<span class="dv">12</span>,<span class="dv">293</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>Females_N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">171</span>,<span class="dv">282</span>,<span class="dv">228</span>,<span class="dv">191</span>,<span class="dv">165</span>,<span class="dv">212</span>,<span class="dv">257</span>,<span class="dv">45</span>,<span class="dv">124</span>,<span class="dv">108</span>,<span class="dv">45</span>,<span class="dv">125</span>,<span class="dv">12</span>,<span class="dv">38</span>,<span class="dv">128</span>,<span class="dv">77</span>,<span class="dv">34</span>,<span class="dv">45</span>,<span class="dv">63</span>,<span class="dv">58</span>,<span class="dv">26</span>,<span class="dv">245</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>ex9 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Year, Inbreeding_coefficient, Males_N, Females_N)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>ex9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Year Inbreeding_coefficient Males_N Females_N
1  1990                  0.000     198       171
2  1991                  0.000     262       282
3  1992                  0.000     255       228
4  1993                  0.000     196       191
5  1994                  0.001     182       165
6  1995                  0.004     283       212
7  1996                  0.021     291       257
8  1997                  0.028      33        45
9  1998                  0.016     131       124
10 1999                  0.013     119       108
11 2000                  0.034      61        45
12 2001                  0.018     120       125
13 2002                  0.021       6        12
14 2003                  0.016      23        38
15 2004                  0.021     135       128
16 2007                  0.027      81        77
17 2008                  0.029      32        34
18 2009                  0.030      41        45
19 2010                  0.033      56        63
20 2011                  0.039      25        58
21 2012                  0.048      12        26
22 2013                  0.046     293       245</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>ex9<span class="sc">|&gt;</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">N_e =</span> <span class="dv">4</span><span class="sc">*</span>(Males_N<span class="sc">*</span>Females_N)<span class="sc">/</span>(Males_N<span class="sc">+</span>Females_N))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Year Inbreeding_coefficient Males_N Females_N       N_e
1  1990                  0.000     198       171 367.02439
2  1991                  0.000     262       282 543.26471
3  1992                  0.000     255       228 481.49068
4  1993                  0.000     196       191 386.93540
5  1994                  0.001     182       165 346.16715
6  1995                  0.004     283       212 484.81616
7  1996                  0.021     291       257 545.89051
8  1997                  0.028      33        45  76.15385
9  1998                  0.016     131       124 254.80784
10 1999                  0.013     119       108 226.46696
11 2000                  0.034      61        45 103.58491
12 2001                  0.018     120       125 244.89796
13 2002                  0.021       6        12  16.00000
14 2003                  0.016      23        38  57.31148
15 2004                  0.021     135       128 262.81369
16 2007                  0.027      81        77 157.89873
17 2008                  0.029      32        34  65.93939
18 2009                  0.030      41        45  85.81395
19 2010                  0.033      56        63 118.58824
20 2011                  0.039      25        58  69.87952
21 2012                  0.048      12        26  32.84211
22 2013                  0.046     293       245 533.71747</code></pre>
</div>
</div>
<p>I did both of the calculations also in excel and here are the answers following the formulas:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="24.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>